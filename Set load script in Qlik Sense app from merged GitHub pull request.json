{"blocks":[{"id":"A87F5625-9E8C-46BB-9C78-5F71627E610B","type":"StartBlock","disabled":false,"name":"OnNewPullRequest","displayName":"On New Pull Request","comment":"Specify the repo containing the load script and the the name of the user or group that owns the repo.","childId":"409EB384-5642-44BC-AF83-8AF33E3E3DD1","inputs":[{"id":"run_mode","value":"webhook","type":"select","structure":{}},{"id":"datasourcetype_guid","value":"0d87808f-27c0-11ea-921c-022e6b5ea1e2","type":"select","displayValue":"GitHub","structure":[]},{"id":"webhook_event_guid","value":"fa303a80-356d-11ec-9cbd-c3e60e70eb72","type":"select","displayValue":"On new pull request","structure":[]},{"id":"webhook_param_47774aa0-3572-11ec-8b6a-eb9703c4bc13","value":"QFP-Scripts-Monitoring","type":"string","structure":[]},{"id":"webhook_param_ada65780-3e4e-11ec-bda0-bd1312668442","value":"magikcypress","type":"string","structure":[]},{"id":"test_payload","value":"{\n  \"action\": \"opened\",\n  \"number\": 2,\n  \"sender\": {\n    \"id\": 21031067,\n    \"login\": \"Codertocat\"\n  },\n  \"repository\": {\n    \"id\": 186853002,\n    \"url\": \"https://api.github.com/repos/Codertocat/Hello-World\",\n    \"fork\": false,\n    \"name\": \"Hello-World\",\n    \"size\": 0,\n    \"forks\": 0,\n    \"owner\": {\n      \"id\": 21031067,\n      \"login\": \"Codertocat\"\n    },\n    \"git_url\": \"git://github.com/Codertocat/Hello-World.git\",\n    \"license\": null,\n    \"node_id\": \"MDEwOlJlcG9zaXRvcnkxODY4NTMwMDI=\",\n    \"private\": false,\n    \"ssh_url\": \"git@github.com:Codertocat/Hello-World.git\",\n    \"svn_url\": \"https://github.com/Codertocat/Hello-World\",\n    \"archived\": false,\n    \"disabled\": false,\n    \"has_wiki\": true,\n    \"homepage\": null,\n    \"html_url\": \"https://github.com/Codertocat/Hello-World\",\n    \"language\": null,\n    \"watchers\": 0,\n    \"clone_url\": \"https://github.com/Codertocat/Hello-World.git\",\n    \"full_name\": \"Codertocat/Hello-World\",\n    \"has_pages\": true,\n    \"pushed_at\": \"2019-05-15T15:20:32Z\",\n    \"created_at\": \"2019-05-15T15:19:25Z\",\n    \"has_issues\": true,\n    \"mirror_url\": null,\n    \"updated_at\": \"2019-05-15T15:19:27Z\",\n    \"description\": null,\n    \"forks_count\": 0,\n    \"open_issues\": 2,\n    \"has_projects\": true,\n    \"has_downloads\": true,\n    \"default_branch\": \"master\",\n    \"watchers_count\": 0,\n    \"stargazers_count\": 0,\n    \"open_issues_count\": 2\n  },\n  \"pull_request\": {\n    \"id\": 279147437,\n    \"url\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/2\",\n    \"base\": {\n      \"ref\": \"master\",\n      \"sha\": \"f95f852bd8fca8fcc58a9a2d6c842781e32a215e\",\n      \"repo\": {\n        \"id\": 186853002,\n        \"url\": \"https://api.github.com/repos/Codertocat/Hello-World\",\n        \"fork\": false,\n        \"name\": \"Hello-World\",\n        \"size\": 0,\n        \"forks\": 0,\n        \"owner\": {\n          \"id\": 21031067,\n          \"login\": \"Codertocat\"\n        },\n        \"git_url\": \"git://github.com/Codertocat/Hello-World.git\",\n        \"license\": null,\n        \"node_id\": \"MDEwOlJlcG9zaXRvcnkxODY4NTMwMDI=\",\n        \"private\": false,\n        \"ssh_url\": \"git@github.com:Codertocat/Hello-World.git\",\n        \"svn_url\": \"https://github.com/Codertocat/Hello-World\",\n        \"archived\": false,\n        \"disabled\": false,\n        \"has_wiki\": true,\n        \"homepage\": null,\n        \"html_url\": \"https://github.com/Codertocat/Hello-World\",\n        \"language\": null,\n        \"watchers\": 0,\n        \"clone_url\": \"https://github.com/Codertocat/Hello-World.git\",\n        \"full_name\": \"Codertocat/Hello-World\",\n        \"has_pages\": true,\n        \"pushed_at\": \"2019-05-15T15:20:32Z\",\n        \"created_at\": \"2019-05-15T15:19:25Z\",\n        \"has_issues\": true,\n        \"mirror_url\": null,\n        \"updated_at\": \"2019-05-15T15:19:27Z\",\n        \"description\": null,\n        \"forks_count\": 0,\n        \"open_issues\": 2,\n        \"has_projects\": true,\n        \"has_downloads\": true,\n        \"default_branch\": \"master\",\n        \"watchers_count\": 0,\n        \"stargazers_count\": 0,\n        \"open_issues_count\": 2,\n        \"allow_merge_commit\": true,\n        \"allow_rebase_merge\": true,\n        \"allow_squash_merge\": true,\n        \"delete_branch_on_merge\": false\n      },\n      \"user\": {\n        \"id\": 21031067,\n        \"login\": \"Codertocat\"\n      },\n      \"label\": \"Codertocat:master\"\n    },\n    \"body\": \"This is a pretty simple change that we need to pull into master.\",\n    \"head\": {\n      \"ref\": \"changes\",\n      \"sha\": \"ec26c3e57ca3a959ca5aad62de7213c562f8c821\",\n      \"repo\": {\n        \"id\": 186853002,\n        \"url\": \"https://api.github.com/repos/Codertocat/Hello-World\",\n        \"fork\": false,\n        \"name\": \"Hello-World\",\n        \"size\": 0,\n        \"forks\": 0,\n        \"owner\": {\n          \"id\": 21031067,\n          \"login\": \"Codertocat\"\n        },\n        \"git_url\": \"git://github.com/Codertocat/Hello-World.git\",\n        \"license\": null,\n        \"node_id\": \"MDEwOlJlcG9zaXRvcnkxODY4NTMwMDI=\",\n        \"private\": false,\n        \"ssh_url\": \"git@github.com:Codertocat/Hello-World.git\",\n        \"svn_url\": \"https://github.com/Codertocat/Hello-World\",\n        \"archived\": false,\n        \"disabled\": false,\n        \"has_wiki\": true,\n        \"homepage\": null,\n        \"html_url\": \"https://github.com/Codertocat/Hello-World\",\n        \"language\": null,\n        \"watchers\": 0,\n        \"clone_url\": \"https://github.com/Codertocat/Hello-World.git\",\n        \"full_name\": \"Codertocat/Hello-World\",\n        \"has_pages\": true,\n        \"pushed_at\": \"2019-05-15T15:20:32Z\",\n        \"created_at\": \"2019-05-15T15:19:25Z\",\n        \"has_issues\": true,\n        \"mirror_url\": null,\n        \"updated_at\": \"2019-05-15T15:19:27Z\",\n        \"description\": null,\n        \"forks_count\": 0,\n        \"open_issues\": 2,\n        \"has_projects\": true,\n        \"has_downloads\": true,\n        \"default_branch\": \"master\",\n        \"watchers_count\": 0,\n        \"stargazers_count\": 0,\n        \"open_issues_count\": 2,\n        \"allow_merge_commit\": true,\n        \"allow_rebase_merge\": true,\n        \"allow_squash_merge\": true,\n        \"delete_branch_on_merge\": false\n      },\n      \"user\": {\n        \"id\": 21031067,\n        \"login\": \"Codertocat\"\n      },\n      \"label\": \"Codertocat:changes\"\n    },\n    \"user\": {\n      \"id\": 21031067,\n      \"login\": \"Codertocat\"\n    },\n    \"draft\": false,\n    \"state\": \"open\",\n    \"title\": \"Update the README with new information.\",\n    \"_links\": {\n      \"html\": {\n        \"href\": \"https://github.com/Codertocat/Hello-World/pull/2\"\n      },\n      \"self\": {\n        \"href\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/2\"\n      },\n      \"issue\": {\n        \"href\": \"https://api.github.com/repos/Codertocat/Hello-World/issues/2\"\n      },\n      \"commits\": {\n        \"href\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/2/commits\"\n      },\n      \"comments\": {\n        \"href\": \"https://api.github.com/repos/Codertocat/Hello-World/issues/2/comments\"\n      },\n      \"statuses\": {\n        \"href\": \"https://api.github.com/repos/Codertocat/Hello-World/statuses/ec26c3e57ca3a959ca5aad62de7213c562f8c821\"\n      },\n      \"review_comment\": {\n        \"href\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/comments{/number}\"\n      },\n      \"review_comments\": {\n        \"href\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/2/comments\"\n      }\n    },\n    \"labels\": [],\n    \"locked\": false,\n    \"merged\": false,\n    \"number\": 2,\n    \"commits\": 1,\n    \"node_id\": \"MDExOlB1bGxSZXF1ZXN0Mjc5MTQ3NDM3\",\n    \"assignee\": null,\n    \"comments\": 0,\n    \"diff_url\": \"https://github.com/Codertocat/Hello-World/pull/2.diff\",\n    \"html_url\": \"https://github.com/Codertocat/Hello-World/pull/2\",\n    \"additions\": 1,\n    \"assignees\": [],\n    \"closed_at\": null,\n    \"deletions\": 1,\n    \"issue_url\": \"https://api.github.com/repos/Codertocat/Hello-World/issues/2\",\n    \"mergeable\": null,\n    \"merged_at\": null,\n    \"merged_by\": null,\n    \"milestone\": null,\n    \"patch_url\": \"https://github.com/Codertocat/Hello-World/pull/2.patch\",\n    \"created_at\": \"2019-05-15T15:20:33Z\",\n    \"rebaseable\": null,\n    \"updated_at\": \"2019-05-15T15:20:33Z\",\n    \"commits_url\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/2/commits\",\n    \"comments_url\": \"https://api.github.com/repos/Codertocat/Hello-World/issues/2/comments\",\n    \"statuses_url\": \"https://api.github.com/repos/Codertocat/Hello-World/statuses/ec26c3e57ca3a959ca5aad62de7213c562f8c821\",\n    \"changed_files\": 1,\n    \"mergeable_state\": \"unknown\",\n    \"requested_teams\": [],\n    \"review_comments\": 0,\n    \"merge_commit_sha\": null,\n    \"author_association\": \"OWNER\",\n    \"review_comment_url\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/comments{/number}\",\n    \"requested_reviewers\": [],\n    \"review_comments_url\": \"https://api.github.com/repos/Codertocat/Hello-World/pulls/2/comments\",\n    \"maintainer_can_modify\": false\n  }\n}","type":"json","structure":[]},{"id":"webhook_documentation","value":null,"type":"string","structure":{}}],"settings":[{"id":"datasource","value":"3755ee92-8504-429f-a8eb-42bd0770b542","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":{}}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":739,"y":-922,"logo":"https://cdn.qlikcloud.com/automations/logos/a2e80ed47e8740769dd715947f347a85.png"},{"id":"E28D2529-4264-4B59-B476-800002BFC08A","type":"SnippetBlock","disabled":false,"name":"getFileContent","displayName":"Git Hub - Get File Content","comment":"Get the content of the first file in the pull request. Use the Lookup Item In List block if your request can contain multiple files.","childId":"A3DF1BC8-13B5-4E8F-AEC9-A859E5481DCA","inputs":[{"id":"21106dd0-4dfc-11ec-a482-93a5e8968b38","value":"{$.OnNewPullRequest.repository.owner.login}","type":"string","structure":[]},{"id":"21120f70-4dfc-11ec-93e4-593d695411a3","value":"{$.OnNewPullRequest.repository.name}","type":"string","structure":[]},{"id":"21177080-4dfc-11ec-9c8b-efdc62b8ca33","value":"{$.OnNewPullRequest.pull_request.head.ref}","type":"string","structure":[]},{"id":"2113b090-4dfc-11ec-a1b9-ef8e8b1e1ba8","value":"{$.listPullRequestFiles[0].filename}","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"3755ee92-8504-429f-a8eb-42bd0770b542","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":460,"y":435,"datasourcetype_guid":"0d87808f-27c0-11ea-921c-022e6b5ea1e2","snippet_guid":"20f9f420-4dfc-11ec-b8c0-fd862f59bb21"},{"id":"2BD5305E-08ED-4B64-A0EA-7E5884094C2E","type":"EndpointBlock","disabled":false,"name":"sendMessage","displayName":"Slack - Send Message","comment":"Alert your team that the load script was updated and the app was reloaded.","childId":null,"inputs":[{"id":"89579ea0-c548-11eb-b9e0-9fea01e8ca23","value":null,"type":"string","structure":[]},{"id":"8961fc70-c548-11eb-8ae2-f728bc67e19f","value":"Load script test for {$.listPullRequestFiles[0].filename} succeeded.\n{$.GetAppInformation.info.attributes.name} is updated & reloaded with this script.","type":"string","structure":[]},{"id":"896a8470-c548-11eb-9a4c-430357e86626","value":null,"type":"string","structure":[]},{"id":"8970c910-c548-11eb-bd5b-594189a86540","value":null,"type":"string","structure":[]},{"id":"8977a3c0-c548-11eb-ac6d-918c14d2f88c","value":null,"type":"string","structure":[]},{"id":"8c4cbdf0-cd1c-11eb-af0e-e595e2810f0d","value":null,"type":"string","structure":[]},{"id":"ecce34c0-cd1c-11eb-b6e4-139d5ce8c99e","value":null,"type":"select","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":1300,"y":-88,"datasourcetype_guid":"0d86ee8a-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"893cc900-c548-11eb-b967-a9fc4c267c43","endpoint_role":"create"},{"id":"8975264B-784A-4746-AD58-DE28EA6CA570","type":"EndpointBlock","disabled":false,"name":"listPullRequestFiles","displayName":"GitHub - List Pull Request Files","comment":"List all files from the pull request.","childId":"E28D2529-4264-4B59-B476-800002BFC08A","inputs":[{"id":"b722ddb0-aa41-11ea-b18b-bfe610643d19","value":"{$.OnNewPullRequest.repository.owner.login}","type":"string","structure":[]},{"id":"b725a2e0-aa41-11ea-a134-c77ec44604e9","value":"{$.OnNewPullRequest.repository.name}","type":"string","structure":[]},{"id":"b72a2d80-aa41-11ea-b3b8-f9235592c409","value":"{ $.OnNewPullRequest.number }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"3755ee92-8504-429f-a8eb-42bd0770b542","type":"select","structure":[]},{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":765,"y":-239,"loopBlockId":null,"datasourcetype_guid":"0d87808f-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"b717a3c0-aa41-11ea-970e-4f9d7e24fffc","endpoint_role":"list"},{"id":"A3DF1BC8-13B5-4E8F-AEC9-A859E5481DCA","type":"SnippetBlock","disabled":false,"name":"GetAppInformation","displayName":"Qlik Cloud Services - Get App Information","comment":"Specify the target app you want to use for this automation. Load script from merged pull requests will be used to update the target app's load script.","childId":"69186AB9-9344-415D-8BD7-797431D5A132","inputs":[{"id":"d3acbdc0-a8d2-11eb-8827-056900eab788","value":"7403860d-34c2-447e-9c45-233acbc4b939","type":"string","displayValue":"App Analyzer - v3.0.2 (7403860d-34c2-447e-9c45-233acbc4b939)","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":282,"y":538,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"d3a8d4f0-a8d2-11eb-a81d-ffabb68491fb"},{"id":"EAB565F5-FDEA-464D-BC70-470E62BC8336","type":"StopBlock","disabled":false,"name":"stop","displayName":"Stop","comment":"Stop automation because the pull request was not merged.","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":926,"y":-369},{"id":"AE932667-BDC7-4157-BAEF-991F31F98B01","type":"SnippetBlock","disabled":false,"name":"DoReload","displayName":"Qlik Cloud Services - Do Reload","comment":"Reload the target app now it has the new script.","childId":"614BD419-0F3A-489D-9FA4-0B327B607D73","inputs":[{"id":"29603390-e716-11ea-9e37-05e08ee32111","value":"{$.GetAppInformation.info.attributes.id}","type":"string","structure":[]},{"id":"2ac9eef0-a677-11eb-aacc-8b755d0fe484","value":"Wait for reload to complete","type":"select","displayValue":"Wait for reload to complete","structure":[]},{"id":"6892c0c0-c795-11eb-9860-9dc8cb705e25","value":null,"type":"select","structure":[]},{"id":"ecebf340-c797-11eb-8671-53658babb1a1","value":null,"type":"select","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":712,"y":173,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"b5dbb7a0-e715-11ea-b2bf-43bb35adee19"},{"id":"409EB384-5642-44BC-AF83-8AF33E3E3DD1","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"Was the pull request merged and closed?","childId":"8975264B-784A-4746-AD58-DE28EA6CA570","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.OnNewPullRequest.action}","input2":"closed","operator":"="},{"input1":"{$.OnNewPullRequest.pull_request.merged}","input2":null,"operator":"isTrue"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":true},{"name":"no","isCollapsed":false}],"x":124,"y":-286,"childTrueId":null,"childFalseId":"EAB565F5-FDEA-464D-BC70-470E62BC8336"},{"id":"69186AB9-9344-415D-8BD7-797431D5A132","type":"EndpointBlock","disabled":false,"name":"setLoadScript","displayName":"Qlik Cloud Services - Set Load Script","comment":"Set the load script in the target app in the shared space.","childId":"AE932667-BDC7-4157-BAEF-991F31F98B01","inputs":[{"id":"917b8660-a12b-11ed-873f-fd156b9f0ebb","value":"{$.GetAppInformation.info.attributes.id}","type":"string","structure":[]},{"id":"d31e0400-a12c-11ed-b43b-29c58fb1f869","value":"{base64decode: {$.getFileContent}}","type":"string","structure":[]},{"id":"0da08560-a12d-11ed-92bf-6146d9e01e80","value":null,"type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":390,"y":-26,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"916661a0-a12b-11ed-882f-fb01a4e99b0a","endpoint_role":"create"},{"id":"614BD419-0F3A-489D-9FA4-0B327B607D73","type":"EndpointBlock","disabled":false,"name":"sendMessage2","displayName":"Microsoft Teams - Send Message 2","comment":"","childId":null,"inputs":[{"id":"ce80c8c0-d33a-11eb-a1be-fb85dcd48977","value":"7264bde2-cd80-4660-8b4d-ef3881321e5e","type":"string","displayValue":"Qlik France Platform","structure":[]},{"id":"ce8be4d0-d33a-11eb-aa74-37bc58fc7293","value":"19:9fb1f2036f894a83a36a4d4ebb4a3f9f@thread.skype","type":"string","displayValue":"Platform","structure":[]},{"id":"ce9788f0-d33a-11eb-a754-31a1e548ae07","value":"Load script test for {$.listPullRequestFiles[0].filename} succeeded.\n{$.GetAppInformation.info.attributes.name} is updated & reloaded with this script.","type":"string","structure":[]},{"id":"cebb4240-d33a-11eb-86c4-cf0a4f744ace","value":null,"type":"string","structure":[]}],"settings":[{"id":"datasource","value":"7e3bfabf-c52f-4ea9-a639-e6963e4def4c","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":449,"y":-443,"datasourcetype_guid":"0d87af8f-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"ce5ffe30-d33a-11eb-b284-3955388e8c59","endpoint_role":"create"}],"variables":[{"guid":"01BA998A-475B-4F0A-9E96-18CDCF965568","name":"GitHubSettings","type":"object"}]}